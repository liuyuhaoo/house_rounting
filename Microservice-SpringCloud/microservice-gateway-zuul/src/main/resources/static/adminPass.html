<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<script type="text/javascript" src="../js/jquery.min.js" ></script>
<script>

</script>
<body onload="order()">
<form id="form1" onsubmit="return false" action="##" >
    关键词<input type="text" name="keyword" id="keyword"/><br>
    排序方式：</br>
    按时间排序<input type="radio" name="orderBy" id="orderBy2" value="time"/><br>
    按价格排序<input type="radio" name="orderBy" id="orderBy3" value="price"/><br>
    审核状态：</br>
    审核通过<input type="radio" name="status" id="status1" value="1"/><br>
    审核中<input type="radio" name="status" id="status2" value="2"/><br>
    审核失败<input type="radio" name="status" id="status3" value="3"/><br>
    <input type="hidden" name="userId" id="userId">
    <input type="button" value="提交" onclick="order()">
</form>
<table  style="height:400px;margin-bottom: 0px;" class="table table-bordered">
    <thead>
    <tr>
        <th>标题</th>
        <th>价格</th>
        <th>时间</th>
        <th>销量</th>
        <th>通过</th>
        <th>不通过</th>
    </tr>
    </thead>
    <tbody id="t_body">
    </tbody>
</table>
</body>
<script>
    function order() {
        userInfo = JSON.parse(sessionStorage.getItem('userInfo'));
        $.ajax({
            type : "GET",
            async: true,
            url : "house/listByUserId",
            dataType : "json",        //返回数据形式为json
            data: $('#form1').serialize(),
            success : function(result) {
                var str = "";
                var data = result.data;
                for(var i=0;i<data.length ;i++){
                    str += "<tr>" +
                        "<td><a href=\"javascript:detail(\'"+data[i].houseId+"')\">" + data[i].title + "</a></td>" +
                        "<td>" + data[i].price + "</td>" +
                        "<td>" + data[i].time + "</td>" +
                        "<td>" + data[i].sale + "</td>" +
                        "<td><a href=\"javascript:pass(\'"+data[i].houseId+"')\">通过</a></td>" +
                        "<td><a href=\"javascript:unpass(\'"+data[i].houseId+"')\">不通过</a></td>" +
                        "</tr>";
                }
                $("#t_body").html("");
                $("#t_body").append(str);
            },
            error : function(errorMsg) {

            }
        })
    }
    function detail(houseId) {
        sessionStorage.removeItem("houseId");
        sessionStorage.setItem("houseId", houseId);
        window.location.href = 'houseInfoDetail.html';
    }
    function pass(houseId) {
        $.ajax({
            type : "PUT",
            async: true,
            url : "house/pass",
            dataType : "json",        //返回数据形式为json
            data: {"id": houseId},
            success : function(result) {
                if (result.status == 200) {
                    alert(result.msg);
                    if(result.msg=="审核通过"){
                        window.location.href = 'adminPass.html';
                    }
                }
            },
            error : function(errorMsg) {

            }
        })
    }
    function unpass(houseId) {
        $.ajax({
            type : "PUT",
            async: true,
            url : "house/unpass",
            dataType : "json",        //返回数据形式为json
            data: {"id": houseId},
            success : function(result) {
                if (result.status == 200) {
                    alert(result.msg);
                    if(result.msg=="审核不通过"){
                        window.location.href = 'adminPass.html';
                    }
                }
            },
            error : function(errorMsg) {

            }
        })
    }
</script>

</html>