<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<script type="text/javascript" src="../js/jquery.min.js" ></script>
<script>

</script>
<body onload="order()">
<form id="form1" onsubmit="return false" action="##" >
    关键词<input type="text" name="keyword" id="keyword"/><br>
    排序方式：</br>
    按时间排序<input type="radio" name="orderBy" id="orderBy2" value="time"/><br>
    按价格排序<input type="radio" name="orderBy" id="orderBy3" value="price"/><br>
    <input type="hidden" name="userId" id="userId">
    <input type="button" value="提交" onclick="order()">
</form>
<table  style="height:400px;margin-bottom: 0px;" class="table table-bordered">
    <thead>
    <tr>
        <th>标题</th>
        <th>价格</th>
        <th>时间</th>
        <th>销量</th>
        <th>修改</th>
        <th>删除</th>
    </tr>
    </thead>
    <tbody id="t_body">
    </tbody>
</table>
</body>
<script>
    function order() {
        userInfo = JSON.parse(sessionStorage.getItem('userInfo'));
        document.getElementById('userId').value=userInfo.id;
        $.ajax({
            type : "GET",
            async: true,
            url : "house/listByUserId",
            dataType : "json",        //返回数据形式为json
            data: $('#form1').serialize(),
            success : function(result) {
                var str = "";
                var data = result.data;
                for(var i=0;i<data.length ;i++){
                    str += "<tr>" +
                        "<td><a href=\"javascript:detail(\'"+data[i].houseId+"')\">" + data[i].title + "</a></td>" +
                        "<td>" + data[i].price + "</td>" +
                        "<td>" + data[i].time + "</td>" +
                        "<td>" + data[i].sale + "</td>" +
                        "<td><a href=\"javascript:update(\'"+data[i].houseId+"')\">编辑</a></td>" +
                        "<td><a href=\"javascript:detele(\'"+data[i].houseId+"')\">删除</a></td>" +
                        "</tr>";
                }
                $("#t_body").html("");
                $("#t_body").append(str);
            },
            error : function(errorMsg) {

            }
        })
    }
    function detail(houseId) {
        sessionStorage.removeItem("houseId");
        sessionStorage.setItem("houseId", houseId);
        window.location.href = 'houseInfoDetail.html';
    }
    function detele(houseId) {
        $.ajax({
            type : "DELETE",
            async: true,
            url : "house/delete",
            dataType : "json",        //返回数据形式为json
            data: {"id": houseId},
            success : function(result) {
                if (result.status == 200) {
                    alert(result.msg);
                    if(result.msg=="删除成功"){
                        window.location.href = 'houseList.html';
                    }
                }
            },
            error : function(errorMsg) {

            }
        })
    }
    function update(houseId) {
        sessionStorage.removeItem("updateHouseId");
        sessionStorage.setItem("updateHouseId", houseId);
        window.location.href = 'updateHouseInfo.html';
    }
</script>

</html>